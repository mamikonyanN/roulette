<!DOCTYPE html>
<!--suppress JSCheckFunctionSignatures, PointlessArithmeticExpressionJS, CssUnknownTarget, CheckImageSize, HtmlUnknownTarget -->
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Roulette</title>
    <link rel="shortcut icon" href="./media/icon.png">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html {
            /*background: #0f0;*/
            background: gray;
        }

        :root {
            --borderColor: white;
        }

        .exp {
            --borderColor: gold;
        }

        .wheel {
            width: 500px;
            height: 500px;
            background: url("../media/back.jpeg") center center no-repeat;
            color: white;
            border-radius: 50%;
            border: 2px solid var(--borderColor);
            position: relative;
        }

        .task {
            height: 50%;
            text-align: center;
            transform-origin: 00% 100%;
            border-left: 1px solid;
            border-right: 1px solid;
            border-color: var(--borderColor);
            position: absolute;
            clip-path: polygon(100% 0, 0 0, 50% 100%);
            left: 50%;
            top: 0;
            padding-top: 1rem;
        }

        .task:before {
            z-index: 1;
            top: 0;
            bottom: 0;
            left: 0;
            right: 0;
            content: " ";
            background: var(--borderColor);
        }

    </style>
</head>
<body>
<div class="wheel">
</div>

<button>rotate</button>
<script src="../js/anime.min.js"></script>
<script>
    let prev = 0, next = 0;

    const wishes = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12];
    const wheel = document.querySelector('.wheel');

    wheel.innerHTML = '';

    const radius = 250;

    const angle = 360 / wishes.length;
    const width = 2 * radius * Math.sin((angle / 2) * (Math.PI / 180));
    const height = Math.sqrt((radius ** 2) - ((width / 2) ** 2));

    document.querySelector('button').onclick = function () {
        document.body.className = anime.random(0, 1) ? '' : 'exp';

        wheel.innerHTML = '';

        wishes.forEach(function (_, index) {
            let div = document.createElement("div");
            div.classList.add('task');
            div.style.top = `${radius - height - 2}px`;
            div.style.width = `${width}px`;
            div.style.height = `${height}px`;
            div.style.transform = `rotate(${(360 / wishes.length) * index}deg) translateX(-50%)`;
            div.innerHTML = (index + 1).toString();
            wheel.appendChild(div);
        });

        next = (anime.random(0, 360)) + (anime.random(4, 9) * 360);
        anime({
            targets: '.wheel',
            rotate: {
                value: [prev, next],
                duration: 5000,
                easing: 'cubicBezier(.3, 0, .5, 1)'
            }
        }).restart();
        prev = next % 360;

    };
</script>
</body>
</html>
